---
- name: ensure facts
  include_tasks: _get_version.yaml

- name: Remove pre-existing firewall rules (1.3-)
  vyos.vyos.vyos_config:
    lines:
      - delete firewall name
      - delete firewall ipv6-name
  ignore_errors: true
  vars:
    ansible_connection: ansible.netcommon.network_cli
  when: vyos_version is version('1.4.0', '<', version_type='semver')

- name: Remove pre-existing firewall rules (1.4+)
  vyos.vyos.vyos_config:
    lines:
      - delete firewall ipv4
      - delete firewall ipv6
  ignore_errors: true
  vars:
    ansible_connection: ansible.netcommon.network_cli
  when: vyos_version is version('1.4.0', '>=', version_type='semver')