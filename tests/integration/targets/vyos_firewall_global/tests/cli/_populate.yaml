---
- ansible.builtin.include_tasks: _remove_config.yaml

- name: ensure facts
  include_tasks: _get_version.yaml

- name: Setup {{ vyos_version }}
  vyos.vyos.vyos_config:
    lines: "{{ populate_config }}"
  vars:
    ansible_connection: ansible.netcommon.network_cli
    
---
- ansible.builtin.include_tasks: _remove_config.yaml

- name: Setup
  vars:
    lines: >-
      set firewall all-ping 'enable'

      set firewall broadcast-ping 'enable'

      set firewall config-trap 'enable'

      set firewall group address-group MGMT-HOSTS address '192.0.1.1'

      set firewall group address-group MGMT-HOSTS address '192.0.1.3'

      set firewall group address-group MGMT-HOSTS address '192.0.1.5'

      set firewall group address-group MGMT-HOSTS description 'This group has
      the Management hosts address list'

      set firewall group network-group MGMT description 'This group has the
      Management network addresses'

      set firewall group network-group MGMT network '192.0.1.0/24'

      set firewall ip-src-route 'enable'

      set firewall log-martians 'enable'

      set firewall receive-redirects 'disable'

      set firewall send-redirects 'enable'

      set firewall source-validation 'strict'

      set firewall state-policy established action 'accept'

      set firewall state-policy established log 'enable'

      set firewall state-policy invalid action 'reject'

      set firewall syn-cookies 'enable'

      set firewall twa-hazards-protection 'enable'
  ansible.netcommon.cli_config:
    config: "{{ lines }}"
